<template>
    <div class="post">
       <div class="type">
         <object class="ava" data="static/img/${props.post.type}.svg"></object>
         <div class="meta">
          <div class="name">${name()}</div>
          <div class="time">
           ${date()}
          </div>
         </div>
       </div>
     <div class="disc">
       <div class="text">
        ${props.post.shorttext}
       </div>
       <a href="/p/${props.post.name}/"><button class="col button button-outline button-raised">посмотреть</button></a>
     </div>
     <!-- <div class="gal">
      <img data-src="https://chuk.dx.am/cock/storage/uploads${formatthumb}" id='post-${props.post.name}' alt='Приложение «трип» постер.png' id='post-${props.post.name}-img' class="lazy lazy-fade-in post-img"/>

     </div> -->
     <div class="swiper-container gal">
      <div class="swiper-wrapper">
        <div class="swiper-slide">
          <a href="/p/${props.post.name}/">
            <img data-src="https://chuk.dx.am/cock/storage/uploads${formatthumb()}" id='post-${props.post.name}' alt='Приложение «трип» постер.png' id='post-${props.post.name}-img' class="lazy lazy-fade-in post-img"/>
          </a>
        </div>
        ${props.post.gall.map((item)=>$h`
          <div class="swiper-slide">
            <a href="/p/${props.post.name}/">
              ${item.meta.type == "contain" && $h`
              <img data-src="https://chuk.dx.am${item.path}" style="object-fit: contain; object-position: ${item.meta.pos};" id='post-${props.post.name}' alt='Приложение «трип» постер.png' id='post-${props.post.name}-img' class="lazy lazy-fade-in post-img"/>
                <div class="bg"></div>
                `
              }
              ${item.meta.type !== "contain" &&  $h`
              <img data-src="https://chuk.dx.am${item.path}" style="object-fit: cover; object-position: ${item.meta.pos};" id='post-${props.post.name}' alt='Приложение «трип» постер.png' id='post-${props.post.name}-img' class="lazy lazy-fade-in post-img"/>

                `
          
              }
            </a>
          </div>
        `)}
      </div>
      <i class="f7-icons snext size-22">arrow_right</i>
      <i class="f7-icons sprew size-22">arrow_left</i>
  </div>

<!-- 
  <style innerHTML=${`
    @media(hover: hover) and (pointer: fine) {
      #post-${props.post.name}:hover img {
        box-shadow:${props.post.postcss.boxshadow};
      ${props.post.postcss.filter} !important;
      }
    }

    #post-${props.post.name}.active-state img{
      box-shadow:${props.post.postcss.boxshadow};
      ${props.post.postcss.filter} !important;
    }
    ${props.post.postcss.animation}`}>
    
  </style> -->
</div>
</template>
<script>


  export default (props, {
    $store,
    $f7,
    $h,
    $update,
    $onMounted,
    $el
  }) => {
    let name = ()=>{
      switch (props.post.type) {
        case 'order':
          return 'заказ'
          break;
          case 'update':
          return 'обновление'
          break;
          case 'mywork':
          return 'свой проект'
          break;
      }
    }
    var moment = require('moment');
    window.mom = moment;
    moment.lang('ru');
    let date=()=>{
      return moment(props.post.published.date).format('D MMMM YYYY')
    }

    let format = (ifnot='jpg')=>{
      if ($store.state.gf.support_format_webp()) {
        return 'webp'
      }else{
        return ifnot
      }
    }

    let formatthumb = ()=>{
      if ($store.state.gf.support_format_webp()) {
        return props.post.thumbwebp.path
      }else{
        return props.post.thumbjpg.path
      }
    }


    $onMounted(()=>{  
      window.ttr=$el.value[0];
      setTimeout(() => {
        var swiper = $f7.swiper.create($el.value[0].childNodes[2], {
        speed: 400,
        spaceBetween: 0,
        navigation: {
          nextEl: '.snext',
          prevEl: '.sprew',
          disabledClass:'dis',
          lockClass:'dis',
          hiddenClass:'dis'
        },
        mousewheel: {
    invert: false,
  },
      });
      }, 10);
    });

    return $render;
  }
</script>